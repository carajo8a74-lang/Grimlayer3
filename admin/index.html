<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex" />
    <title>Admin — Grimlayer</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <script src="https://unpkg.com/decap-cms@^3.4.1/dist/decap-cms.js"></script>
    <style>
      html,body{height:100%;background:#0b0d10;color:#c9d1d9}
      .boot{position:fixed;bottom:32px;left:0;right:0;text-align:center;font:16px/1.6 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Inter,Helvetica,Arial}
      a{color:#58a6ff;text-decoration:none}
    </style>
  </head>
  <body>
    <div class="boot">Loading Admin…  <a href="/admin/health.html">Health check</a></div>
    <script>
      window.CMS_MANUAL_INIT = true;
      const config = {
        backend: { name: 'git-gateway', branch: 'main' },
        site_url: 'https://grimlayertattoo.com',
        display_url: 'https://grimlayertattoo.com',
        media_folder: 'assets/uploads',
        public_folder: '/assets/uploads',
        collections: [
          {
            name: 'portfolio',
            label: 'Portfolio',
            label_singular: 'Piece',
            folder: 'content/portfolio',
            create: true,
            slug: '{{slug}}',
            fields: [
              { label: 'Title', name: 'title', widget: 'string' },
              { label: 'Date', name: 'date', widget: 'datetime' },
              { label: 'Description', name: 'body', widget: 'text' },
              { label: 'Image', name: 'image', widget: 'image' }
            ]
          }
        ]
      };
      CMS.init({ config });
      if (window.netlifyIdentity) {
        window.netlifyIdentity.on('init', (user) => {
          if (!user) {
            window.netlifyIdentity.on('login', () => { document.location.reload(); });
          }
        });
      }
    </script>
  </body>
</html>
